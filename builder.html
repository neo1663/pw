<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>リンクまとめツール</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .link-row { display: flex; gap: 6px; margin-bottom: 6px; }
    .link-row input { flex: 1; }
    #preview { width: 100%; height: 500px; border: 1px solid #ccc; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>リンクまとめツール</h1>
  <section>
    <label>タイトル <input id="title"></label><br>
    <label>説明 <input id="desc"></label><br>
    <label>背景色1 <input type="color" id="bg1" value="#FFDEE9"></label>
    <label>背景色2 <input type="color" id="bg2" value="#B5FFFC"></label><br>
    <label>ボタン背景 <input type="color" id="btnBg" value="#FFFFFF"></label>
    <label>ボタン文字色 <input type="color" id="btnColor" value="#333333"></label>
    <label>角丸 <input type="number" id="btnRadius" value="12" min="0"></label>
  </section>
  <h2>リンク</h2>
  <div id="links"></div>
  <button id="addLink">リンク追加</button>
  <h2>共有URL</h2>
  <input id="result" style="width:100%" readonly>
  <h2>プレビュー</h2>
  <iframe id="preview"></iframe>
  <script>
    const linksEl = document.getElementById('links');
    function addLinkRow(link = {label:'', url:'', icon:''}) {
      const div = document.createElement('div');
      div.className = 'link-row';
      div.innerHTML = `<input placeholder="テキスト" class="label" value="${link.label}">
                       <input placeholder="URL" class="url" value="${link.url}">
                       <input placeholder="アイコンURL" class="icon" value="${link.icon}">
                       <button class="remove">✕</button>`;
      div.querySelector('.remove').onclick = () => { div.remove(); update(); };
      linksEl.appendChild(div);
    }
    document.getElementById('addLink').onclick = () => { addLinkRow(); update(); };
    addLinkRow();
    addLinkRow();
    function buildConfig() {
      const cfg = {
        title: document.getElementById('title').value,
        description: document.getElementById('desc').value,
        background: `linear-gradient(135deg, ${document.getElementById('bg1').value}, ${document.getElementById('bg2').value})`,
        button: {
          background: document.getElementById('btnBg').value,
          color: document.getElementById('btnColor').value,
          radius: parseInt(document.getElementById('btnRadius').value) || 0
        },
        links: []
      };
      linksEl.querySelectorAll('.link-row').forEach(row => {
        const label = row.querySelector('.label').value;
        const url = row.querySelector('.url').value;
        const icon = row.querySelector('.icon').value;
        if (url) cfg.links.push({label, url, icon});
      });
      return cfg;
    }
    function update() {
      const cfg = buildConfig();
      const encoded = btoa(unescape(encodeURIComponent(JSON.stringify(cfg))));
      const url = 'index.html#' + encoded;
      document.getElementById('result').value = url;
      document.getElementById('preview').src = url;
    }
    document.querySelectorAll('input').forEach(el => el.addEventListener('input', update));
    linksEl.addEventListener('input', update);
    update();
  </script>
</body>
</html>
